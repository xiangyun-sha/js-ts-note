# Screen 对象

[TOC]

---

`screen` 对象是浏览器对象模型（BOM）中提供用户屏幕信息的对象。它包含了显示器的尺寸、色彩深度、可用空间等信息。通过 `screen` 对象，开发者可以获取用户屏幕的物理特性，从而调整页面布局、选择合适的图像资源或优化用户体验。

---

## 1. 概述

`window.screen` 对象（或直接使用 `screen`）包含了有关当前显示器/屏幕的信息。这些信息是只读的，反映了底层显示设备的属性。它在以下场景中特别有用：

- **响应式设计**：根据屏幕宽度选择不同的布局或资源。
- **游戏/多媒体应用**：获取屏幕尺寸以适配全屏显示。
- **统计分析**：了解用户常见的屏幕分辨率分布。
- **窗口管理**：计算新窗口的最佳位置和大小。

**注意**：`screen` 对象提供的是整个屏幕的尺寸，而非浏览器窗口或文档的尺寸。窗口尺寸应使用 `window.innerWidth`/`innerHeight` 或 `document.documentElement.clientWidth`/`clientHeight`。

---

## 2. 常用属性

`screen` 对象的主要属性描述了显示器的物理特征和当前配置。

### 2.1 尺寸相关属性

| 属性           | 描述                                                                   | 示例值 |
| -------------- | ---------------------------------------------------------------------- | ------ |
| `width`        | 屏幕的总宽度（以像素为单位）。                                         | `1920` |
| `height`       | 屏幕的总高度（以像素为单位）。                                         | `1080` |
| `availWidth`   | 屏幕的可用宽度（除去操作系统任务栏等占用的区域）。                     | `1920` |
| `availHeight`  | 屏幕的可用高度（除去操作系统任务栏等占用的区域）。                     | `1040` |
| `availLeft`    | 可用区域的左边距（相对于主屏幕的左侧，通常为 0）。                     | `0`    |
| `availTop`     | 可用区域的顶部边距（相对于主屏幕的顶部，通常为 0）。                   | `0`    |
| `left` / `top` | 当前屏幕相对于多屏幕系统的左上角坐标（通常只在多显示器环境中有意义）。 | `0`    |

**注意**：`availHeight` 通常小于 `height`，因为任务栏（如 Windows 的任务栏）会占用一部分空间。在多显示器环境下，`availLeft`/`availTop` 可能非零。

```javascript
console.log(`屏幕分辨率: ${screen.width} x ${screen.height}`);
console.log(`可用区域: ${screen.availWidth} x ${screen.availHeight}`);
```

### 2.2 色彩与像素相关属性

| 属性          | 描述                                                                  | 示例值 |
| ------------- | --------------------------------------------------------------------- | ------ |
| `colorDepth`  | 屏幕的色彩深度（每个像素用于显示颜色的位数）。通常为 `24` 或 `32`。   | `24`   |
| `pixelDepth`  | 屏幕的像素深度（与 `colorDepth` 基本相同，通常相等）。                | `24`   |
| `orientation` | 返回一个 `ScreenOrientation` 对象，包含屏幕方向信息（如角度、类型）。 | 对象   |

```javascript
console.log(`色彩深度: ${screen.colorDepth} 位`);
```

**注意**：`colorDepth` 和 `pixelDepth` 通常相同，但在某些老旧设备上可能有差异。它们可用于判断是否需要加载高色彩图像。

### 2.3 屏幕方向

`screen.orientation` 属性返回一个 `ScreenOrientation` 对象，提供有关屏幕当前方向的信息，并允许锁定方向。

常用属性和方法：

- **`type`**：返回方向类型，如 `"portrait-primary"`、`"landscape-primary"` 等。
- **`angle`**：从默认方向顺时针旋转的角度（0、90、180、270）。
- **`lock(orientation)`**：锁定屏幕到指定方向（返回 Promise）。需要用户手势触发，且受设备支持。
- **`unlock()`**：解锁屏幕方向。

```javascript
if (screen.orientation) {
  console.log('当前方向:', screen.orientation.type);
  console.log('旋转角度:', screen.orientation.angle);
}

// 锁定为横向（需要用户手势）
button.addEventListener('click', async () => {
  try {
    await screen.orientation.lock('landscape');
    console.log('屏幕已锁定为横向');
  } catch (err) {
    console.log('锁定失败:', err);
  }
});
```

---

## 3. 其他属性

- **`mozEnabled`** / **`mozBrightness`**（Firefox 特定）：
  用于控制屏幕亮度的属性，但已被部分浏览器废弃。

- **`onorientationchange`**（已废弃）：
  早期移动浏览器用于监听方向变化的事件，现在推荐使用 `screen.orientation.onchange` 或 `window.matchMedia` 监听方向变化。

---

## 4. 实际应用示例

### 4.1 根据屏幕尺寸设置 Canvas 大小

```javascript
const canvas = document.getElementById('game');
function resizeCanvas() {
  canvas.width = screen.availWidth;
  canvas.height = screen.availHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);
```

### 4.2 检测小屏幕以加载移动版资源

```javascript
if (screen.width < 768) {
  loadMobileStylesheet();
} else {
  loadDesktopStylesheet();
}
```

**注意**：更好的做法是使用 CSS 媒体查询（`@media`），但某些情况下需要 JavaScript 干预。

### 4.3 打开新窗口并居中

```javascript
function openCenteredWindow(url, width, height) {
  const left = (screen.width - width) / 2;
  const top = (screen.height - height) / 2;
  const features = `width=${width},height=${height},left=${left},top=${top}`;
  window.open(url, '_blank', features);
}
```

### 4.4 检测屏幕方向变化

```javascript
if (screen.orientation) {
  screen.orientation.addEventListener('change', () => {
    console.log('屏幕方向变为:', screen.orientation.type);
  });
} else {
  // 降级使用 resize 事件
  window.addEventListener('resize', () => {
    const isLandscape = window.innerWidth > window.innerHeight;
    console.log(isLandscape ? '横向' : '纵向');
  });
}
```

### 4.5 判断是否处于省电模式或低色彩深度（示例）

```javascript
// 如果色彩深度较低，可能为单色或低端设备
if (screen.colorDepth <= 8) {
  // 使用简化的图像或图标
}
```

---

## 5. 最佳实践与注意事项

1. **不要混淆屏幕尺寸与窗口尺寸**  
   - `screen.width` 是整个显示器的宽度，而 `window.innerWidth` 是浏览器视口的宽度。在响应式设计中，应优先使用视口尺寸。

2. **多显示器环境**  
   - 当有多个显示器时，`screen` 对象代表的是当前窗口所在的显示器。`screen.availLeft`/`availTop` 可用于判断该显示器在多显示器布局中的位置。

3. **移动端与桌面端的差异**  
   - 移动设备上，`screen.width` 通常返回物理像素值（如 `375`），但 CSS 像素可能不同（受设备像素比影响）。要获取 CSS 像素尺寸，应使用 `window.innerWidth`。

4. **屏幕方向 API 需要用户手势**  
   - `screen.orientation.lock()` 必须由用户手势（如点击事件）触发，并且仅在支持锁屏的设备上有效（通常是移动端或平板）。

5. **不要依赖屏幕尺寸做关键业务决策**  
   - 屏幕尺寸可能被用户修改（如通过操作系统缩放）或虚拟化，应使用渐进增强策略。

6. **性能考量**  
   - 读取 `screen` 属性非常快，但频繁读取（如动画循环中）并无必要。通常只需在初始化时读取一次，或在 `resize` 事件中根据需要读取。

7. **兼容性**  
   - 大多数属性在所有浏览器中都得到良好支持。`screen.orientation` 在移动端和现代桌面浏览器中支持较好，但仍建议在使用前进行特性检测。

---

## 6. 总结

`screen` 对象提供了关于用户显示设备的基础信息，是开发者调整布局、优化资源、实现全屏功能的重要工具。通过本章的学习，你应该能够：

- 使用 `screen.width`、`screen.height` 获取屏幕总尺寸。
- 使用 `screen.availWidth`、`screen.availHeight` 获取可用空间。
- 利用 `screen.colorDepth` 评估色彩能力。
- 通过 `screen.orientation` 检测和锁定屏幕方向。
- 结合实际场景（如居中窗口、响应式设计）应用这些属性。

记住，`screen` 关注的是硬件屏幕，而视口尺寸才是页面布局的直接依据。合理结合两者，可以创造出更好的用户体验。

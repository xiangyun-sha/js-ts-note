# 注释

[TOC]

---

注释是代码中不可或缺的组成部分，它们不会被 JavaScript 引擎执行，主要用于：

- 解释代码的意图、逻辑或复杂算法。
- 临时禁用某段代码（调试时常用）。
- 生成文档（通过特定格式的注释）。
- 标记待办事项、修复项或优化点。

良好的注释习惯能极大提升代码的可读性和可维护性。本章将详细介绍 JavaScript 中的注释类型及其使用规范。

---

## 1. 单行注释

### 语法

单行注释以两个斜杠 `//` 开头，从 `//` 到行尾的所有内容都会被忽略。

```javascript
// 这是一个单行注释
let name = 'Alice'; // 也可以放在代码行末尾
```

### 使用场景

- **解释单行代码**：当某行代码的意图不直观时，添加简短说明。

  ```javascript
  const MAX_RETRIES = 3; // 最大重试次数
  ```

- **临时禁用代码**：在调试时，可以通过注释掉某行来测试效果。

  ```javascript
  // console.log('调试信息');
  ```

- **标记待办事项**：常与 `TODO`、`FIXME` 等关键词结合（见“自定义注释”部分）。

### 快捷键

大多数编辑器（如 VS Code）中，按 `Ctrl + /`（Windows/Linux）或 `Cmd + /`（Mac）可以快速添加或取消单行注释。

### 最佳实践

- 注释应简洁明了，避免废话。
- 不要为显而易见的代码添加注释（如 `i++; // 增加 i`）。
- 注释与代码之间建议保留一个空格（如 `// 这是一条注释`）。

---

## 2. 多行注释

### 语法

多行注释以 `/*` 开头，以 `*/` 结尾，可以跨越多行。

```javascript
/*
  这是一个多行注释
  它可以跨越多行
  非常适合写较长的说明
*/
let x = 10;
```

也可以在同一行内使用，但通常不推荐：

```javascript
let y = 20; /* 这也是多行注释 */ let z = 30;
```

### 使用场景

- **文件/模块头部说明**：描述文件作用、作者、创建日期等。

  ```javascript
  /*
   * 文件名: utils.js
   * 描述: 提供通用的工具函数
   * 作者: Zhang San
   * 日期: 2025-01-01
   */
  ```

- **注释掉大段代码**：调试时临时禁用一块代码（注意不能嵌套）。

  ```javascript
  /*
  function oldFunction() {
    // 一些逻辑
  }
  */
  ```

### 注意：不能嵌套

多行注释内部不能包含另一个 `/* */`，否则会导致语法错误。

```javascript
/*
  这是外层注释
  /* 这是内层注释 */ // 错误！内层注释会提前结束外层注释
*/
```

### 最佳实践

- 避免在代码中间使用多行注释，以免破坏代码可读性。
- 对于暂时注释掉的代码块，建议添加说明，如 `// TODO: 待优化后启用`。

---

## 3. 块注释（文档注释）

### 语法

块注释特指以 `/**` 开头、`*/` 结尾的注释，通常用于为函数、类、变量等生成文档。这种注释遵循 **JSDoc** 规范，可以被工具（如 JSDoc、TypeScript）解析，自动生成 API 文档。

```javascript
/**
 * 计算两个数字之和
 * @param {number} a - 第一个加数
 * @param {number} b - 第二个加数
 * @returns {number} 两数之和
 */
function add(a, b) {
  return a + b;
}
```

### 常用标签

| 标签          | 描述               | 示例                               |
| ------------- | ------------------ | ---------------------------------- |
| `@param`      | 描述函数参数       | `@param {string} name - 用户名`    |
| `@returns`    | 描述返回值         | `@returns {boolean} 是否成功`      |
| `@throws`     | 描述可能抛出的异常 | `@throws {Error} 当参数无效时`     |
| `@example`    | 提供使用示例       | `@example add(1, 2) // 返回 3`     |
| `@deprecated` | 标记为已弃用       | `@deprecated 请使用新方法`         |
| `@see`        | 参考链接或相关说明 | `@see {@link https://example.com}` |

### 使用场景

- **公共 API 文档**：为库或模块的导出函数、类添加详细注释。
- **团队协作**：统一注释风格，方便他人理解和使用代码。
- **IDE 智能提示**：许多编辑器（VS Code）能解析 JSDoc，在调用函数时显示参数说明。

### 最佳实践

- 保持注释与代码同步更新，避免文档过时。
- 对复杂的函数或类，即使不生成文档，也推荐添加块注释帮助理解。
- 对于简单的内部函数，可酌情省略。

---

## 4. 自定义注释（项目/团队约定）

在实际开发中，团队通常会约定一些特殊标记，用于标注待办事项、修复点、优化建议等。这些标记配合编辑器插件，可以生成任务列表，提高协作效率。

### 常见标记

| 标记       | 含义                   | 示例                            |
| ---------- | ---------------------- | ------------------------------- |
| `TODO`     | 待完成的功能或改进     | `// TODO: 添加输入验证`         |
| `FIXME`    | 已知问题或潜在错误     | `// FIXME: 边界条件处理不正确`  |
| `HACK`     | 临时解决方案，需要重构 | `// HACK: 绕过浏览器兼容性问题` |
| `BUG`      | 已确认的缺陷           | `// BUG: 某些情况下会崩溃`      |
| `OPTIMIZE` | 性能优化点             | `// OPTIMIZE: 可缓存计算结果`   |
| `NOTE`     | 重要说明               | `// NOTE: 该变量会在后续复用`   |

### 示例

```javascript
function processData(data) {
  // TODO: 处理空数据的情况
  // FIXME: 当 data 包含 null 时出错
  // OPTIMIZE: 使用 Set 替代数组去重
  return data.map(item => item.value);
}
```

### 团队约定建议

- **统一标记格式**：例如要求标记后跟冒号和空格（`// TODO: 说明`）。
- **添加责任人**：大型项目可在标记后加上负责人（`// TODO(zhangsan): 实现分页`）。
- **定期清理**：在代码审查或版本发布前，检查并处理所有标记。

### 工具支持

- 许多编辑器（如 VS Code）通过插件（如 **Todo Tree**）可以高亮这些标记，并在侧边栏汇总列表，方便追踪。
- 团队还可以在 CI 流程中扫描 `TODO` 或 `FIXME`，生成报告或阻止合并（如设置规则禁止 `FIXME` 出现在主分支）。

---

## 注释的最佳实践总结

1. **解释“为什么”而不是“是什么”**  
   好的注释应该说明代码背后的意图、决策原因，而不是重复代码本身。  
   ❌ `// 循环遍历数组`  
   ✅ `// 需要遍历每个用户，发送欢迎邮件`

2. **保持简洁**  
   注释应简短有力，避免冗长。如果需要大量说明，考虑重构代码使其更清晰。

3. **及时更新**  
   修改代码时，务必同步更新相关注释，避免误导。

4. **使用一致的风格**  
   团队应制定注释规范（如 JSDoc 格式、标记约定），并在代码审查中执行。

5. **注释不是万能的**  
   优先追求代码自解释（良好的命名、清晰的逻辑），注释作为补充。

---

## 小结

JavaScript 中的注释类型丰富，各有用途：

- **单行注释**：快速解释或临时禁用单行代码。
- **多行注释**：用于大段说明或注释掉代码块。
- **块注释（JSDoc）**：为函数、类等生成结构化文档，增强 IDE 提示。
- **自定义注释**：通过约定标记，管理待办和问题。

掌握注释的用法，并养成良好的注释习惯，将使你的代码更易读、更易维护，也为团队协作打下坚实基础。下一节我们将正式进入 JavaScript 的基础语法学习。
